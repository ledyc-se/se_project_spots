!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);o&&(o.textContent="")},o=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?(n(t,r),t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},c=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),c=e.querySelector(t.submitButtonSelector);o(n,c,t),n.forEach((a=>{a.addEventListener("input",(function(){((e,t,o)=>{t.validity.valid?r(e,t):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,o)})(e,a,t),o(n,c,t)}))}))})(t,e)}))};c(t);var a=e+"d3610e9c6dce3cb370d8.svg",l=e+"2fc47fd8e9a9bcd9612f.jpg",d=e+"d38272e02bb4f1ab1c37.svg",s=e+"40608da7369d39bc1077.svg";document.getElementById("spotsLogo").src=a;const i=document.getElementById("profile-avatar");i.src=l,document.getElementById("pencil-icon").src=d,document.getElementById("plus-icon").src=s;const u=document.querySelector(".profile__name"),m=document.querySelector(".profile__description"),_=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers,method:"GET"}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"405e0a22-ee55-4a2d-b905-d3c2cbdb8a74","Content-Type":"application/json"}});_.getAppInfo().then((e=>{let[t]=e;t.forEach((e=>{const t=D(e);$.append(t)}))})).catch((e=>console.error("Error:",e))),_.getUserInfo().then((e=>{let[t]=e;u.textContent=t.name,i.src=t.avatar,m.textContent=t.about})).catch((e=>console.error("Error:",e)));const v=document.querySelector(".profile__edit-btn"),p=document.querySelector(".modal__form"),y=document.querySelector("#edit-modal"),f=document.querySelector(".modal__close-btn"),S=y.querySelector("#profile-name-input"),b=y.querySelector("#profile-description-input"),q=document.querySelector("#add-card-modal"),E=q.querySelector(".modal__close-btn"),h=document.querySelector(".profile__add-btn"),g=q.querySelector(".modal__form"),L=q.querySelector("#add-card-name-input"),k=q.querySelector("#add-card-link-input"),C=document.querySelector("#preview-modal"),B=C.querySelector(".modal__image"),I=C.querySelector(".modal__caption"),x=C.querySelector(".modal__close-btn-preview"),U=g.querySelector(".modal__button"),j=document.querySelector("#card-template"),$=document.querySelector(".cards__list");function w(e){e.classList.add("modal_opened"),e.addEventListener("click",A),document.addEventListener("keydown",T)}function A(e){e.target.classList.contains("modal")&&P(e.target)}function P(e){e.classList.remove("modal_opened"),e.removeEventListener("click",A),document.removeEventListener("keydown",T)}function D(e){const t=j.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),c=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,n.addEventListener("click",(()=>{n.classList.toggle("card__like-button_liked")})),o.addEventListener("click",(()=>{w(C),I.textContent=e.name,B.src=e.link,B.alt=e.name})),c.addEventListener("click",(()=>{t.remove()})),t}function T(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&P(e)}}v.addEventListener("click",(()=>{var e,n,c,a;S.value=u.textContent,b.value=m.textContent,e=p,n=[S,b],c=p.querySelector(".modal__submit-btn"),a=t,n.forEach((t=>{r(e,t)})),o(n,c,a),w(y)})),f.addEventListener("click",(()=>{P(y)})),x.addEventListener("click",(()=>{P(C)})),p.addEventListener("submit",(function(e){e.preventDefault(),u.textContent=S.value,m.textContent=b.value,P(y)})),h.addEventListener("click",(()=>{w(q)})),E.addEventListener("click",(()=>{P(q)})),g.addEventListener("submit",(function(e){e.preventDefault();const r={name:L.value,link:k.value};e.target.reset();const o=D(r);$.prepend(o),P(q),disableButton(U,t)})),c(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixFQUFpQjNCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcclxufTtcclxuXHJcbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTXNnLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaWYgKGVycm9yTXNnRWwpIHtcclxuICAgIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoXHJcbiAgICAgIGZvcm1FbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQsXHJcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcclxuICAgICAgY29uZmlnXHJcbiAgICApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKHN1Ym1pdEJ1dHRvbiwgY29uZmlnKTtcclxuICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChzdWJtaXRCdXR0b24sIGNvbmZpZykgPT4ge1xyXG4gIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChcclxuICBmb3JtRWxlbWVudCxcclxuICBpbnB1dExpc3QsXHJcbiAgc3VibWl0QnV0dG9uLFxyXG4gIGNvbmZpZ1xyXG4pID0+IHtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCk7XHJcbiAgfSk7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBzdWJtaXRCdXR0b24sIGNvbmZpZyk7XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXHJcbiAgKTtcclxuICBjb25zdCBzdWJtaXRCdXR0b24gPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgc3VibWl0QnV0dG9uLCBjb25maWcpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgc3VibWl0QnV0dG9uLCBjb25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IHJlc2V0VmFsaWRhdGlvbiB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcclxuaW1wb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiB9IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcclxuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcbmltcG9ydCBsb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvc3BvdHMtbG9nby5zdmdcIjtcclxuaW1wb3J0IGF2YXRhclNyYyBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcclxuaW1wb3J0IHBlbmNpbFNyYyBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbC1pY29uLnN2Z1wiO1xyXG5pbXBvcnQgcGx1c1NyYyBmcm9tIFwiLi4vaW1hZ2VzL3BsdXMtc2lnbi1pY29uLnN2Z1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuXHJcbmNvbnN0IHNwb3RzTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3BvdHNMb2dvXCIpO1xyXG5zcG90c0xvZ28uc3JjID0gbG9nb1NyYztcclxuY29uc3Qgc3BvdHNBdmF0YXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGUtYXZhdGFyXCIpO1xyXG5zcG90c0F2YXRhci5zcmMgPSBhdmF0YXJTcmM7XHJcbmNvbnN0IHNwb3RzUGVuY2lsSWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGVuY2lsLWljb25cIik7XHJcbnNwb3RzUGVuY2lsSWNvbi5zcmMgPSBwZW5jaWxTcmM7XHJcbmNvbnN0IHNwb3RzUGx1c0ljb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsdXMtaWNvblwiKTtcclxuc3BvdHNQbHVzSWNvbi5zcmMgPSBwbHVzU3JjO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuXHJcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIkdvbGRlbiBHYXRlIGJyaWRnZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzctcGhvdG8tYnktZ3JpZmZpbi13b29sZHJpZGdlLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzQtcGhvdG8tYnktbWF1cmljZS1sYXNjaGV0LWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiNDA1ZTBhMjItZWU1NS00YTJkLWI5MDUtZDNjMmNiZGI4YTc0XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vZGVzdHJ1Y3Rpb24gdGhlIDJuZCBpdGVtIGluIHRoZSBjYWxsYmFjayBvZiB0aGUgLnRoZW4sIGhhbmRsZSB1c2VyIGluZm9cclxuYXBpXHJcbiAgLmdldEFwcEluZm8oKVxyXG4gIC50aGVuKChbY2FyZHNdKSA9PiB7XHJcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XHJcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnIpKTtcclxuXHJcbmFwaVxyXG4gIC5nZXRVc2VySW5mbygpXHJcbiAgLnRoZW4oKFt1c2VyRGF0YV0pID0+IHtcclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIHNwb3RzQXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvcjpcIiwgZXJyKSk7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XHJcblxyXG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XHJcbmNvbnN0IGVkaXRNb2RhbENsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBlZGl0TW9kYWxOYW1lSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuXHJcbmNvbnN0IGNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGNhcmRNb2RhbENsb3NlQnRuID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuY29uc3QgY2FyZE1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xyXG5jb25zdCBjYXJkRm9ybU1vZGFsTmV3UG9zdCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBlZGl0Q2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGVkaXRDYXJkTGlua0lucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcclxuXHJcbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcclxuY29uc3QgcHJldmlld01vZGFsSW1nRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbENhcHRpb25FbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19jbG9zZS1idG4tcHJldmlld1wiXHJcbik7XHJcbmNvbnN0IGNhcmRTdWJtaXRCdG4gPSBjYXJkRm9ybU1vZGFsTmV3UG9zdC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZU1vZGFsT3ZlcmxheSk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbE92ZXJsYXkoZXZ0KSB7XHJcbiAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XHJcbiAgfVxyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgZWRpdEZvcm1FbGVtZW50LFxyXG4gICAgW2VkaXRNb2RhbE5hbWVJbnB1dCwgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dF0sXHJcbiAgICBlZGl0Rm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKSxcclxuICAgIHNldHRpbmdzXHJcbiAgKTtcclxuXHJcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgbW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsb3NlTW9kYWxPdmVybGF5KTtcclxuXHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZTtcclxuICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU5ld1Bvc3RGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IGlucHV0VmFsdWVzID0ge1xyXG4gICAgbmFtZTogZWRpdENhcmROYW1lSW5wdXQudmFsdWUsXHJcbiAgICBsaW5rOiBlZGl0Q2FyZExpbmtJbnB1dC52YWx1ZSxcclxuICB9O1xyXG5cclxuICBldnQudGFyZ2V0LnJlc2V0KCk7XHJcblxyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaW5wdXRWYWx1ZXMpO1xyXG4gIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcblxyXG4gIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ0biwgc2V0dGluZ3MpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgY29uc3QgY2FyZE5hbWVFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICBjb25zdCBjYXJkSW1hZ2VFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuXHJcbiAgY2FyZE5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIGNhcmRJbWFnZUVsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWFnZUVsZW1lbnQuYWx0ID0gZGF0YS5uYW1lO1xyXG5cclxuICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcclxuXHJcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcblxyXG4gICAgcHJldmlld01vZGFsSW1nRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgcHJldmlld01vZGFsSW1nRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5lZGl0TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxufSk7XHJcblxyXG5wcmV2aWV3TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcclxufSk7XHJcblxyXG5lZGl0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCk7XHJcblxyXG5jYXJkTW9kYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5jYXJkTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5jYXJkRm9ybU1vZGFsTmV3UG9zdC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZU5ld1Bvc3RGb3JtU3VibWl0KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVzY2FwZShldnQpIHtcclxuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgY29uc3QgbW9kYWxPcGVuZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGlmIChtb2RhbE9wZW5lZCkge1xyXG4gICAgICBjbG9zZU1vZGFsKG1vZGFsT3BlbmVkKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJjb25maWciLCJlcnJvck1zZ0VsIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsInN1Ym1pdEJ1dHRvbiIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsImRpc2FibGVkIiwicmVtb3ZlIiwiZW5hYmxlVmFsaWRhdGlvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTXNnIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJnZXRFbGVtZW50QnlJZCIsInNyYyIsImxvZ29TcmMiLCJzcG90c0F2YXRhciIsImF2YXRhclNyYyIsInBlbmNpbFNyYyIsInBsdXNTcmMiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwibWV0aG9kIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzIiwiY2FyZCIsImNhcmRFbGVtZW50IiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkc0xpc3QiLCJhcHBlbmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIl9yZWYyIiwidXNlckRhdGEiLCJuYW1lIiwiYXZhdGFyIiwiYWJvdXQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsImVkaXRGb3JtRWxlbWVudCIsImVkaXRNb2RhbCIsImVkaXRNb2RhbENsb3NlQnRuIiwiZWRpdE1vZGFsTmFtZUlucHV0IiwiZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dCIsImNhcmRNb2RhbCIsImNhcmRNb2RhbENsb3NlQnRuIiwiY2FyZE1vZGFsQnRuIiwiY2FyZEZvcm1Nb2RhbE5ld1Bvc3QiLCJlZGl0Q2FyZE5hbWVJbnB1dCIsImVkaXRDYXJkTGlua0lucHV0IiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsSW1nRWwiLCJwcmV2aWV3TW9kYWxDYXB0aW9uRWwiLCJwcmV2aWV3TW9kYWxDbG9zZUJ0biIsImNhcmRTdWJtaXRCdG4iLCJjYXJkVGVtcGxhdGUiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImNsb3NlTW9kYWxPdmVybGF5IiwiaGFuZGxlRXNjYXBlIiwiZXZ0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImRhdGEiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbGVtZW50IiwiY2FyZEltYWdlRWxlbWVudCIsImNhcmRMaWtlQnRuIiwiY2FyZERlbGV0ZUJ0biIsImxpbmsiLCJhbHQiLCJ0b2dnbGUiLCJrZXkiLCJtb2RhbE9wZW5lZCIsInJlc2V0VmFsaWRhdGlvbiIsInZhbHVlIiwiaW5wdXQiLCJwcmV2ZW50RGVmYXVsdCIsImlucHV0VmFsdWVzIiwicmVzZXQiLCJwcmVwZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==