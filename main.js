!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);o&&(o.textContent="")},o=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?(n(t,r),t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},a=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);o(n,a,t),n.forEach((c=>{c.addEventListener("input",(function(){((e,t,o)=>{t.validity.valid?r(e,t):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,o)})(e,c,t),o(n,a,t)}))}))})(t,e)}))};a(t);var c=e+"d3610e9c6dce3cb370d8.svg",l=e+"2fc47fd8e9a9bcd9612f.jpg",d=e+"d38272e02bb4f1ab1c37.svg",i=e+"40608da7369d39bc1077.svg";document.getElementById("spotsLogo").src=c,document.getElementById("profile-avatar").src=l,document.getElementById("pencil-icon").src=d,document.getElementById("plus-icon").src=i,new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(e){return fetch(`${this._baseUrl}/user/me`,{headers:{authorization:`Bearer ${e}`,method:"GET"}}).then((e=>e.json())).then((e=>{profileName.textContent=e.name,profileDescription.textContent=e.about,profileAvatar.src=e.avatar}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f5b01759-49ad-4d36-941a-cf552fa758d0","Content-Type":"application/json"}}).getAppInfo().then((e=>{let[t,r]=e;u.textContent=t.name,profileAvatar.src=t.avatar,m.textContent=t.about,r.forEach((e=>{const t=w(e);A.append(t)}))})).catch((e=>console.error("Error:",e)));const s=document.querySelector(".profile__edit-btn"),u=document.querySelector(".profile__name"),m=document.querySelector(".profile__description"),_=document.querySelector(".modal__form"),p=document.querySelector("#edit-modal"),v=document.querySelector(".modal__close-btn"),f=p.querySelector("#profile-name-input"),y=p.querySelector("#profile-description-input"),S=document.querySelector("#add-card-modal"),b=S.querySelector(".modal__close-btn"),q=document.querySelector(".profile__add-btn"),E=S.querySelector(".modal__form"),h=S.querySelector("#add-card-name-input"),L=S.querySelector("#add-card-link-input"),g=document.querySelector("#preview-modal"),C=g.querySelector(".modal__image"),k=g.querySelector(".modal__caption"),x=g.querySelector(".modal__close-btn-preview"),B=E.querySelector(".modal__button"),I=document.querySelector("#card-template"),A=document.querySelector(".cards__list");function U(e){e.classList.add("modal_opened"),e.addEventListener("click",$),document.addEventListener("keydown",D)}function $(e){e.target.classList.contains("modal")&&j(e.target)}function j(e){e.classList.remove("modal_opened"),e.removeEventListener("click",$),document.removeEventListener("keydown",D)}function w(e){const t=I.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,n.addEventListener("click",(()=>{n.classList.toggle("card__like-button_liked")})),o.addEventListener("click",(()=>{U(g),k.textContent=e.name,C.src=e.link,C.alt=e.name})),a.addEventListener("click",(()=>{t.remove()})),t}function D(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&j(e)}}s.addEventListener("click",(()=>{var e,n,a,c;f.value=u.textContent,y.value=m.textContent,e=_,n=[f,y],a=_.querySelector(".modal__submit-btn"),c=t,n.forEach((t=>{r(e,t)})),o(n,a,c),U(p)})),v.addEventListener("click",(()=>{j(p)})),x.addEventListener("click",(()=>{j(g)})),_.addEventListener("submit",(function(e){e.preventDefault(),u.textContent=f.value,m.textContent=y.value,j(p)})),q.addEventListener("click",(()=>{U(S)})),b.addEventListener("click",(()=>{j(S)})),E.addEventListener("submit",(function(e){e.preventDefault();const r={name:h.value,link:L.value};e.target.reset();const o=w(r);A.prepend(o),j(S),disableButton(B,t)})),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cHJvamVjdF9zcG90cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1zZywgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gZXJyb3JNc2c7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlmIChlcnJvck1zZ0VsKSB7XHJcbiAgICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKFxyXG4gICAgICBmb3JtRWxlbWVudCxcclxuICAgICAgaW5wdXRFbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsXHJcbiAgICAgIGNvbmZpZ1xyXG4gICAgKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XHJcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBzdWJtaXRCdXR0b24sIGNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgZGlzYWJsZUJ1dHRvbihzdWJtaXRCdXR0b24sIGNvbmZpZyk7XHJcbiAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoc3VibWl0QnV0dG9uLCBjb25maWcpID0+IHtcclxuICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoXHJcbiAgZm9ybUVsZW1lbnQsXHJcbiAgaW5wdXRMaXN0LFxyXG4gIHN1Ym1pdEJ1dHRvbixcclxuICBjb25maWdcclxuKSA9PiB7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQpO1xyXG4gIH0pO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgc3VibWl0QnV0dG9uLCBjb25maWcpO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKTtcclxuXHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyByZXNldFZhbGlkYXRpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcbmltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xyXG5pbXBvcnQgbG9nb1NyYyBmcm9tIFwiLi4vaW1hZ2VzL3Nwb3RzLWxvZ28uc3ZnXCI7XHJcbmltcG9ydCBhdmF0YXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCI7XHJcbmltcG9ydCBwZW5jaWxTcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwtaWNvbi5zdmdcIjtcclxuaW1wb3J0IHBsdXNTcmMgZnJvbSBcIi4uL2ltYWdlcy9wbHVzLXNpZ24taWNvbi5zdmdcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XHJcblxyXG5jb25zdCBzcG90c0xvZ28gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNwb3RzTG9nb1wiKTtcclxuc3BvdHNMb2dvLnNyYyA9IGxvZ29TcmM7XHJcbmNvbnN0IHNwb3RzQXZhdGFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlLWF2YXRhclwiKTtcclxuc3BvdHNBdmF0YXIuc3JjID0gYXZhdGFyU3JjO1xyXG5jb25zdCBzcG90c1BlbmNpbEljb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBlbmNpbC1pY29uXCIpO1xyXG5zcG90c1BlbmNpbEljb24uc3JjID0gcGVuY2lsU3JjO1xyXG5jb25zdCBzcG90c1BsdXNJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbHVzLWljb25cIik7XHJcbnNwb3RzUGx1c0ljb24uc3JjID0gcGx1c1NyYztcclxuXHJcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIkdvbGRlbiBHYXRlIGJyaWRnZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzctcGhvdG8tYnktZ3JpZmZpbi13b29sZHJpZGdlLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG5cclxuICB7XHJcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzQtcGhvdG8tYnktbWF1cmljZS1sYXNjaGV0LWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJBbiBvdXRkb29yIGNhZmVcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZjViMDE3NTktNDlhZC00ZDM2LTk0MWEtY2Y1NTJmYTc1OGQwXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vZGVzdHJ1Y3Rpb24gdGhlIDJuZCBpdGVtIGluIHRoZSBjYWxsYmFjayBvZiB0aGUgLnRoZW4sIGhhbmRsZSB1c2VyIGluZm9cclxuYXBpXHJcbiAgLmdldEFwcEluZm8oKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xyXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgcHJvZmlsZUF2YXRhci5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuXHJcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XHJcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnIpKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcblxyXG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XHJcbmNvbnN0IGVkaXRNb2RhbENsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBlZGl0TW9kYWxOYW1lSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcclxuKTtcclxuXHJcbmNvbnN0IGNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGNhcmRNb2RhbENsb3NlQnRuID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuY29uc3QgY2FyZE1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xyXG5jb25zdCBjYXJkRm9ybU1vZGFsTmV3UG9zdCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBlZGl0Q2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGVkaXRDYXJkTGlua0lucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcclxuXHJcbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcclxuY29uc3QgcHJldmlld01vZGFsSW1nRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbENhcHRpb25FbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19jbG9zZS1idG4tcHJldmlld1wiXHJcbik7XHJcbmNvbnN0IGNhcmRTdWJtaXRCdG4gPSBjYXJkRm9ybU1vZGFsTmV3UG9zdC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZU1vZGFsT3ZlcmxheSk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbE92ZXJsYXkoZXZ0KSB7XHJcbiAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XHJcbiAgfVxyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgZWRpdEZvcm1FbGVtZW50LFxyXG4gICAgW2VkaXRNb2RhbE5hbWVJbnB1dCwgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dF0sXHJcbiAgICBlZGl0Rm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKSxcclxuICAgIHNldHRpbmdzXHJcbiAgKTtcclxuXHJcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgbW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsb3NlTW9kYWxPdmVybGF5KTtcclxuXHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZTtcclxuICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU5ld1Bvc3RGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IGlucHV0VmFsdWVzID0ge1xyXG4gICAgbmFtZTogZWRpdENhcmROYW1lSW5wdXQudmFsdWUsXHJcbiAgICBsaW5rOiBlZGl0Q2FyZExpbmtJbnB1dC52YWx1ZSxcclxuICB9O1xyXG5cclxuICBldnQudGFyZ2V0LnJlc2V0KCk7XHJcblxyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaW5wdXRWYWx1ZXMpO1xyXG4gIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcblxyXG4gIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ0biwgc2V0dGluZ3MpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgY29uc3QgY2FyZE5hbWVFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICBjb25zdCBjYXJkSW1hZ2VFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuXHJcbiAgY2FyZE5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIGNhcmRJbWFnZUVsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWFnZUVsZW1lbnQuYWx0ID0gZGF0YS5uYW1lO1xyXG5cclxuICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcclxuXHJcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcblxyXG4gICAgcHJldmlld01vZGFsSW1nRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgcHJldmlld01vZGFsSW1nRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5lZGl0TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxufSk7XHJcblxyXG5wcmV2aWV3TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcclxufSk7XHJcblxyXG5lZGl0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCk7XHJcblxyXG5jYXJkTW9kYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5jYXJkTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5jYXJkRm9ybU1vZGFsTmV3UG9zdC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZU5ld1Bvc3RGb3JtU3VibWl0KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVzY2FwZShldnQpIHtcclxuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgY29uc3QgbW9kYWxPcGVuZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGlmIChtb2RhbE9wZW5lZCkge1xyXG4gICAgICBjbG9zZU1vZGFsKG1vZGFsT3BlbmVkKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8odG9rZW4pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2VyL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VufWAsXHJcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICAgICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJjb25maWciLCJlcnJvck1zZ0VsIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsInN1Ym1pdEJ1dHRvbiIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsImRpc2FibGVkIiwicmVtb3ZlIiwiZW5hYmxlVmFsaWRhdGlvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTXNnIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJnZXRFbGVtZW50QnlJZCIsInNyYyIsImxvZ29TcmMiLCJhdmF0YXJTcmMiLCJwZW5jaWxTcmMiLCJwbHVzU3JjIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJ0b2tlbiIsImF1dGhvcml6YXRpb24iLCJtZXRob2QiLCJyZXNwb25zZSIsInVzZXJEYXRhIiwicHJvZmlsZU5hbWUiLCJuYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwiYWJvdXQiLCJwcm9maWxlQXZhdGFyIiwiYXZhdGFyIiwiY2FyZHMiLCJjYXJkIiwiY2FyZEVsZW1lbnQiLCJnZXRDYXJkRWxlbWVudCIsImNhcmRzTGlzdCIsImFwcGVuZCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwicHJvZmlsZUVkaXRCdXR0b24iLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWwiLCJlZGl0TW9kYWxDbG9zZUJ0biIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJjYXJkTW9kYWwiLCJjYXJkTW9kYWxDbG9zZUJ0biIsImNhcmRNb2RhbEJ0biIsImNhcmRGb3JtTW9kYWxOZXdQb3N0IiwiZWRpdENhcmROYW1lSW5wdXQiLCJlZGl0Q2FyZExpbmtJbnB1dCIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbEltZ0VsIiwicHJldmlld01vZGFsQ2FwdGlvbkVsIiwicHJldmlld01vZGFsQ2xvc2VCdG4iLCJjYXJkU3VibWl0QnRuIiwiY2FyZFRlbXBsYXRlIiwib3Blbk1vZGFsIiwibW9kYWwiLCJjbG9zZU1vZGFsT3ZlcmxheSIsImhhbmRsZUVzY2FwZSIsImV2dCIsInRhcmdldCIsImNvbnRhaW5zIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJkYXRhIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmROYW1lRWxlbWVudCIsImNhcmRJbWFnZUVsZW1lbnQiLCJjYXJkTGlrZUJ0biIsImNhcmREZWxldGVCdG4iLCJsaW5rIiwiYWx0IiwidG9nZ2xlIiwia2V5IiwibW9kYWxPcGVuZWQiLCJyZXNldFZhbGlkYXRpb24iLCJ2YWx1ZSIsImlucHV0IiwicHJldmVudERlZmF1bHQiLCJpbnB1dFZhbHVlcyIsInJlc2V0IiwicHJlcGVuZCJdLCJzb3VyY2VSb290IjoiIn0=