!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{const n=e.querySelector(`#${t.id}-error`);n&&(n.textContent="")},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?(o(t,r),t.classList.add(r.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},o=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},a=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n(o,a,t),o.forEach((c=>{c.addEventListener("input",(function(){((e,t,n)=>{t.validity.valid?r(e,t):((e,t,r,n)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(n.inputErrorClass)})(e,t,t.validationMessage,n)})(e,c,t),n(o,a,t)}))}))})(t,e)}))};a(t);var c=e+"d3610e9c6dce3cb370d8.svg",d=e+"2fc47fd8e9a9bcd9612f.jpg",l=e+"d38272e02bb4f1ab1c37.svg",s=e+"40608da7369d39bc1077.svg";function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?n:r}document.getElementById("spotsLogo").src=c;const u=document.getElementById("profile-avatar");u.src=d,document.getElementById("pencil-icon").src=l,document.getElementById("plus-icon").src=s;const m=document.querySelector(".profile__name"),_=document.querySelector(".profile__description");let h,v,f;const y=document.querySelector("#delete-confirmation-modal"),p=y.querySelector("#delete-confirmation-form"),b=document.querySelector("#delete-confirmation-button"),S=document.querySelector(".profile__edit-btn"),k=document.querySelector(".modal__form"),q=document.querySelector("#edit-modal"),E=document.querySelector(".modal__close-btn"),L=q.querySelector("#profile-name-input"),g=q.querySelector("#profile-description-input"),C=q.querySelector(".modal__submit-btn"),$=document.querySelector("#add-card-modal"),I=$.querySelector(".modal__close-btn"),U=document.querySelector(".profile__add-btn"),x=$.querySelector(".modal__form"),A=$.querySelector("#add-card-name-input"),B=$.querySelector("#add-card-link-input"),R=x.querySelector(".modal__button"),D=document.querySelector("#card-template"),T=document.querySelector(".cards__list"),P=document.querySelector("#preview-modal"),w=P.querySelector(".modal__image"),j=P.querySelector(".modal__caption"),N=P.querySelector(".modal__close-btn-preview"),O=document.querySelector("#avatar-modal"),J=document.querySelector(".profile__avatar-btn"),H=O.querySelector(".modal__close-btn"),z=O.querySelector(".modal__submit-btn"),G=O.querySelector(".modal__input"),M=O.querySelector(".modal__form"),F=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}checkRespone(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(checkRespone)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers,method:"GET"}).then(checkRespone)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(checkRespone)}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(checkRespone)}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(checkRespone)}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(checkRespone)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(checkRespone)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(checkRespone)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(checkRespone)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"405e0a22-ee55-4a2d-b905-d3c2cbdb8a74","Content-Type":"application/json"}});function K(e){e.classList.add("modal_opened"),e.addEventListener("click",Q),document.addEventListener("keydown",X)}function Q(e){e.target.classList.contains("modal")&&V(e.target)}function V(e){e.classList.remove("modal_opened"),e.removeEventListener("click",Q),document.removeEventListener("keydown",X)}function W(e){const t=D.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.textContent=e.name,n.src=e.link,n.alt=e.name,"true"===localStorage.getItem(`liked-${e._id}`)&&o.classList.add("card__like-button_liked"),o.addEventListener("click",(()=>{(o.classList.contains("card__like-button_liked")?F.unlikeCard(e._id):F.likeCard(e._id)).then((t=>{o.classList.toggle("card__like-button_liked");const r=o.classList.contains("card__like-button_liked");localStorage.setItem(`liked-${e._id}`,r)})).catch(console.error)})),n.addEventListener("click",(()=>{K(P),j.textContent=e.name,w.src=e.link,w.alt=e.name})),a.addEventListener("click",(()=>function(e,t){h=e,v=t,K(y)}(t,e._id))),t}function X(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&V(e)}}F.getAppInfo().then((e=>{let[t,r]=e;f=t._id,m.textContent=t.name,u.src=t.avatar,_.textContent=t.about,r.forEach((e=>{const t=W(e);T.append(t)}))})).catch((e=>console.error("Error:",e))),S.addEventListener("click",(()=>{var e,o,a,c;L.value=m.textContent,g.value=_.textContent,e=k,o=[L,g],a=k.querySelector(".modal__submit-btn"),c=t,o.forEach((t=>{r(e,t)})),n(o,a,c),K(q)})),E.addEventListener("click",(()=>{V(q)})),N.addEventListener("click",(()=>{V(P)})),k.addEventListener("submit",(function(e){e.preventDefault();const t={name:L.value,about:g.value};i(C,!0),F.editUserInfo(t).then((e=>{m.textContent=e.name,_.textContent=e.about,V(q)})).catch(console.error).finally((()=>{i(C,!1)}))})),U.addEventListener("click",(()=>{K($)})),I.addEventListener("click",(()=>{V($)})),x.addEventListener("submit",(function(e){e.preventDefault();const r={name:A.value,link:B.value};i(R,!0),F.addCard(r).then((()=>F.getInitialCards())).then((e=>{const r=W(e[0]);T.prepend(r),V($),x.reset(),o(R,t)})).catch(console.error).finally((()=>{i(R,!1)}))})),J.addEventListener("click",(()=>{K(O)})),H.addEventListener("click",(()=>{V(O)})),M.addEventListener("submit",(function(e){e.preventDefault(),i(z,!0),F.editAvatarInfo(G.value).then((e=>{u.src=e.avatar,V(O),M.reset(),o(z,t)})).catch(console.error).finally((()=>{i(z,!1)}))})),p.addEventListener("submit",(function(e){e.preventDefault(),document.querySelectorAll(".modal__submit-btn"),i(b,!0,"Deleting..."),F.removeCard(v).then((()=>{V(y),h.remove()})).catch(console.error).finally((()=>{i(b,!1,"Delete")}))})),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d0IsRUFBTSxJQUV6QmxGLEVBQVU2RixRQUFRbEMsR0FDbEJILEVBQVdoRSxHQUNYRyxFQUFxQm1HLFFBQ3JCckosRUFBY3FELEVBQWUzRSxFQUFTLElBRXZDd0osTUFBTUMsUUFBUUMsT0FDZGMsU0FBUSxLQUNQakksRUFBY29DLEdBQWUsRUFBTSxHQUV6QyxJQWlIQVEsRUFBZWpELGlCQUFpQixTQUFTLEtBQ3ZDNEYsRUFBVTVDLEVBQVksSUFHeEJFLEVBQWVsRCxpQkFBaUIsU0FBUyxLQUN2Q21HLEVBQVduRCxFQUFZLElBR3pCSyxFQUFXckQsaUJBQWlCLFVBdkg1QixTQUE0QmdHLEdBQzFCQSxFQUFJb0MsaUJBRUovSCxFQUFjOEMsR0FBaUIsR0FFL0JHLEVBQ0c2QixlQUFlL0IsRUFBWThFLE9BQzNCeEQsTUFBTVksSUFDTHRFLEVBQVlGLElBQU13RSxFQUFLRixPQUN2QmUsRUFBV25ELEdBQ1hLLEVBQVdvRixRQUNYckosRUFBYytELEVBQWlCckYsRUFBUyxJQUV6Q3dKLE1BQU1DLFFBQVFDLE9BQ2RjLFNBQVEsS0FDUGpJLEVBQWM4QyxHQUFpQixFQUFNLEdBRTNDLElBd0dBekIsRUFBdUIxQixpQkFBaUIsVUF2RHhDLFNBQTRCZ0csR0FDMUJBLEVBQUlvQyxpQkFFYzFJLFNBQVNDLGlCQUFpQixzQkFFNUNVLEVBQWNzQixHQUF1QixFQUFNLGVBRTNDMkIsRUFDR2lDLFdBQVdoRSxHQUNYbUQsTUFBSyxLQUNKeUIsRUFBVzFFLEdBQ1hILEVBQWE5QixRQUFRLElBRXRCOEgsTUFBTUMsUUFBUUMsT0FDZGMsU0FBUSxLQUNQakksRUFBY3NCLEdBQXVCLEVBQU8sU0FBUyxHQUUzRCxJQWlEQWxDLEVBQWlCM0IsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcclxufTtcclxuXHJcbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTXNnLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaWYgKGVycm9yTXNnRWwpIHtcclxuICAgIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoXHJcbiAgICAgIGZvcm1FbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQsXHJcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcclxuICAgICAgY29uZmlnXHJcbiAgICApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKHN1Ym1pdEJ1dHRvbiwgY29uZmlnKTtcclxuICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoc3VibWl0QnV0dG9uLCBjb25maWcpID0+IHtcclxuICBzdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoXHJcbiAgZm9ybUVsZW1lbnQsXHJcbiAgaW5wdXRMaXN0LFxyXG4gIHN1Ym1pdEJ1dHRvbixcclxuICBjb25maWdcclxuKSA9PiB7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQpO1xyXG4gIH0pO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgc3VibWl0QnV0dG9uLCBjb25maWcpO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKTtcclxuXHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIHN1Ym1pdEJ1dHRvbiwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uVGV4dChcclxuICBidG4sXHJcbiAgaXNMb2FkaW5nLFxyXG4gIF9kZWZhdWx0VGV4dCA9IFwiU2F2ZVwiLFxyXG4gIF9sb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCJcclxuKSB7XHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgYnRuLnRleHRDb250ZW50ID0gX2xvYWRpbmdUZXh0O1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidG4udGV4dENvbnRlbnQgPSBfZGVmYXVsdFRleHQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7XHJcbiAgcmVzZXRWYWxpZGF0aW9uLFxyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbiAgZGlzYWJsZUJ1dHRvbixcclxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xyXG5pbXBvcnQgbG9nb1NyYyBmcm9tIFwiLi4vaW1hZ2VzL3Nwb3RzLWxvZ28uc3ZnXCI7XHJcbmltcG9ydCBhdmF0YXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCI7XHJcbmltcG9ydCBwZW5jaWxTcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwtaWNvbi5zdmdcIjtcclxuaW1wb3J0IHBsdXNTcmMgZnJvbSBcIi4uL2ltYWdlcy9wbHVzLXNpZ24taWNvbi5zdmdcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XHJcbmltcG9ydCB7IHNldEJ1dHRvblRleHQgfSBmcm9tIFwiLi4vdXRpbHMvaGVscGVycy5qc1wiO1xyXG5cclxuY29uc3Qgc3BvdHNMb2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzcG90c0xvZ29cIik7XHJcbnNwb3RzTG9nby5zcmMgPSBsb2dvU3JjO1xyXG5jb25zdCBzcG90c0F2YXRhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS1hdmF0YXJcIik7XHJcbnNwb3RzQXZhdGFyLnNyYyA9IGF2YXRhclNyYztcclxuY29uc3Qgc3BvdHNQZW5jaWxJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwZW5jaWwtaWNvblwiKTtcclxuc3BvdHNQZW5jaWxJY29uLnNyYyA9IHBlbmNpbFNyYztcclxuY29uc3Qgc3BvdHNQbHVzSWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGx1cy1pY29uXCIpO1xyXG5zcG90c1BsdXNJY29uLnNyYyA9IHBsdXNTcmM7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5cclxubGV0IHNlbGVjdGVkQ2FyZDtcclxubGV0IHNlbGVjdGVkQ2FyZElkO1xyXG5sZXQgY3VycmVudFVzZXJJZDtcclxuXHJcbi8vRGVsZXRlXHJcbmNvbnN0IGRlbGV0ZUNvbmZpcm1hdGlvbk1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNkZWxldGUtY29uZmlybWF0aW9uLW1vZGFsXCJcclxuKTtcclxuY29uc3QgZGVsZXRlQ29uZmlybWF0aW9uRm9ybSA9IGRlbGV0ZUNvbmZpcm1hdGlvbk1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjZGVsZXRlLWNvbmZpcm1hdGlvbi1mb3JtXCJcclxuKTtcclxuXHJcbmNvbnN0IGRlbGV0ZUNvbmZpcm1hdGlvbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjZGVsZXRlLWNvbmZpcm1hdGlvbi1idXR0b25cIlxyXG4pO1xyXG5cclxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiR29sZGVuIEdhdGUgYnJpZGdlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIk1vdW50YWluIGhvdXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcblxyXG4gIHtcclxuICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiUmVzdGF1cmFudCB0ZXJyYWNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYWwgVGhvcmVuc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XHJcblxyXG4vL0VkaXRcclxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xyXG5jb25zdCBlZGl0TW9kYWxDbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcbmNvbnN0IGVkaXRTdWJtaXRCdG4gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcclxuXHJcbi8vQ2FyZFxyXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBjYXJkTW9kYWxDbG9zZUJ0biA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IGNhcmRNb2RhbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ0blwiKTtcclxuY29uc3QgY2FyZEZvcm1Nb2RhbE5ld1Bvc3QgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgZWRpdENhcmROYW1lSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0Q2FyZExpbmtJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWxpbmstaW5wdXRcIik7XHJcbmNvbnN0IGNhcmRTdWJtaXRCdG4gPSBjYXJkRm9ybU1vZGFsTmV3UG9zdC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbi8vUHJldmlld1xyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbEltZ0VsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuY29uc3QgcHJldmlld01vZGFsQ2xvc2VCdG4gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fY2xvc2UtYnRuLXByZXZpZXdcIlxyXG4pO1xyXG5cclxuLy9BdmF0YXJcclxuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcclxuY29uc3QgYXZhdGFyTW9kYWxCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idG5cIik7XHJcbmNvbnN0IGF2YXRhckNsb3NlQnRuID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBhdmF0YXJTdWJtaXRCdG4gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xyXG5jb25zdCBhdmF0YXJJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2lucHV0XCIpO1xyXG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjQwNWUwYTIyLWVlNTUtNGEyZC1iOTA1LWQzYzJjYmRiOGE3NFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XHJcbiAgICBjdXJyZW50VXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG5cclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIHNwb3RzQXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xyXG5cclxuICAgIGNhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkKTtcclxuICAgICAgY2FyZHNMaXN0LmFwcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycikpO1xyXG5cclxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2VNb2RhbE92ZXJsYXkpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWxPdmVybGF5KGV2dCkge1xyXG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XHJcbiAgICBjbG9zZU1vZGFsKGV2dC50YXJnZXQpO1xyXG4gIH1cclxufVxyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gIHJlc2V0VmFsaWRhdGlvbihcclxuICAgIGVkaXRGb3JtRWxlbWVudCxcclxuICAgIFtlZGl0TW9kYWxOYW1lSW5wdXQsIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXRdLFxyXG4gICAgZWRpdEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIiksXHJcbiAgICBzZXR0aW5nc1xyXG4gICk7XHJcblxyXG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIG1vZGFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZU1vZGFsT3ZlcmxheSk7XHJcblxyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IGRhdGEgPSB7XHJcbiAgICBuYW1lOiBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUsXHJcbiAgICBhYm91dDogZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSxcclxuICB9O1xyXG5cclxuICBzZXRCdXR0b25UZXh0KGVkaXRTdWJtaXRCdG4sIHRydWUpO1xyXG5cclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8oZGF0YSlcclxuICAgIC50aGVuKCh1cGRhdGVkVXNlcikgPT4ge1xyXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVwZGF0ZWRVc2VyLm5hbWU7XHJcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVwZGF0ZWRVc2VyLmFib3V0O1xyXG4gICAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoZWRpdFN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU5ld1Bvc3RGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCBpbnB1dFZhbHVlcyA9IHtcclxuICAgIG5hbWU6IGVkaXRDYXJkTmFtZUlucHV0LnZhbHVlLFxyXG4gICAgbGluazogZWRpdENhcmRMaW5rSW5wdXQudmFsdWUsXHJcbiAgfTtcclxuXHJcbiAgc2V0QnV0dG9uVGV4dChjYXJkU3VibWl0QnRuLCB0cnVlKTtcclxuXHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZChpbnB1dFZhbHVlcylcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgcmV0dXJuIGFwaS5nZXRJbml0aWFsQ2FyZHMoKTtcclxuICAgIH0pXHJcbiAgICAudGhlbigoY2FyZHMpID0+IHtcclxuICAgICAgY29uc3QgbGF0ZXN0Q2FyZCA9IGNhcmRzWzBdO1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGxhdGVzdENhcmQpO1xyXG4gICAgICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoY2FyZE1vZGFsKTtcclxuICAgICAgY2FyZEZvcm1Nb2RhbE5ld1Bvc3QucmVzZXQoKTtcclxuICAgICAgZGlzYWJsZUJ1dHRvbihjYXJkU3VibWl0QnRuLCBzZXR0aW5ncyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoY2FyZFN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgc2V0QnV0dG9uVGV4dChhdmF0YXJTdWJtaXRCdG4sIHRydWUpO1xyXG5cclxuICBhcGlcclxuICAgIC5lZGl0QXZhdGFySW5mbyhhdmF0YXJJbnB1dC52YWx1ZSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHNwb3RzQXZhdGFyLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuICAgICAgYXZhdGFyRm9ybS5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGF2YXRhclN1Ym1pdEJ0biwgc2V0dGluZ3MpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KGF2YXRhclN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGNhcmROYW1lRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgY29uc3QgY2FyZEltYWdlRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gIGNvbnN0IGNhcmREZWxldGVCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gIGNhcmROYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBjYXJkSW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEubGluaztcclxuICBjYXJkSW1hZ2VFbGVtZW50LmFsdCA9IGRhdGEubmFtZTtcclxuXHJcbiAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBsaWtlZC0ke2RhdGEuX2lkfWApID09PSBcInRydWVcIikge1xyXG4gICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xyXG4gIH1cclxuXHJcbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNvbnN0IGlzTGlrZWQgPSBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcclxuXHJcbiAgICBjb25zdCByZXF1ZXN0ID0gaXNMaWtlZCA/IGFwaS51bmxpa2VDYXJkKGRhdGEuX2lkKSA6IGFwaS5saWtlQ2FyZChkYXRhLl9pZCk7XHJcblxyXG4gICAgcmVxdWVzdFxyXG4gICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XHJcbiAgICAgICAgY29uc3Qgbm93TGlrZWQgPSBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoXHJcbiAgICAgICAgICBcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCJcclxuICAgICAgICApO1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGBsaWtlZC0ke2RhdGEuX2lkfWAsIG5vd0xpa2VkKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcclxuICAgIHByZXZpZXdNb2RhbENhcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHByZXZpZXdNb2RhbEltZ0VsLnNyYyA9IGRhdGEubGluaztcclxuICAgIHByZXZpZXdNb2RhbEltZ0VsLmFsdCA9IGRhdGEubmFtZTtcclxuICB9KTtcclxuXHJcbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEuX2lkKVxyXG4gICk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCBzdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xyXG5cclxuICBzZXRCdXR0b25UZXh0KGRlbGV0ZUNvbmZpcm1hdGlvbkJ0biwgdHJ1ZSwgXCJEZWxldGluZy4uLlwiKTtcclxuXHJcbiAgYXBpXHJcbiAgICAucmVtb3ZlQ2FyZChzZWxlY3RlZENhcmRJZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2xvc2VNb2RhbChkZWxldGVDb25maXJtYXRpb25Nb2RhbCk7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgc2V0QnV0dG9uVGV4dChkZWxldGVDb25maXJtYXRpb25CdG4sIGZhbHNlLCBcIkRlbGV0ZVwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBjYXJkSWQpIHtcclxuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcclxuICBzZWxlY3RlZENhcmRJZCA9IGNhcmRJZDtcclxuICBvcGVuTW9kYWwoZGVsZXRlQ29uZmlybWF0aW9uTW9kYWwpO1xyXG59XHJcblxyXG5lZGl0TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxufSk7XHJcblxyXG5wcmV2aWV3TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcclxufSk7XHJcblxyXG5lZGl0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCk7XHJcblxyXG5jYXJkTW9kYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5jYXJkTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5jYXJkRm9ybU1vZGFsTmV3UG9zdC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZU5ld1Bvc3RGb3JtU3VibWl0KTtcclxuXHJcbmF2YXRhck1vZGFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKGF2YXRhck1vZGFsKTtcclxufSk7XHJcblxyXG5hdmF0YXJDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuXHJcbmF2YXRhckZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJTdWJtaXQpO1xyXG5cclxuZGVsZXRlQ29uZmlybWF0aW9uRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG1vZGFsT3BlbmVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbiAgICBpZiAobW9kYWxPcGVuZWQpIHtcclxuICAgICAgY2xvc2VNb2RhbChtb2RhbE9wZW5lZCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIGNoZWNrUmVzcG9uZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oY2hlY2tSZXNwb25lKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICB9KS50aGVuKGNoZWNrUmVzcG9uZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKGNoZWNrUmVzcG9uZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0QXZhdGFySW5mbyhhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oY2hlY2tSZXNwb25lKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgIH0pLnRoZW4oY2hlY2tSZXNwb25lKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKGNoZWNrUmVzcG9uZSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oY2hlY2tSZXNwb25lKTtcclxuICB9XHJcblxyXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKGNoZWNrUmVzcG9uZSk7XHJcbiAgfVxyXG5cclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbihjaGVja1Jlc3BvbmUpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JNc2dFbCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJzdWJtaXRCdXR0b24iLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJkaXNhYmxlZCIsInJlbW92ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIiwic2V0QnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsIl9kZWZhdWx0VGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIl9sb2FkaW5nVGV4dCIsImdldEVsZW1lbnRCeUlkIiwic3JjIiwibG9nb1NyYyIsInNwb3RzQXZhdGFyIiwiYXZhdGFyU3JjIiwicGVuY2lsU3JjIiwicGx1c1NyYyIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJjdXJyZW50VXNlcklkIiwiZGVsZXRlQ29uZmlybWF0aW9uTW9kYWwiLCJkZWxldGVDb25maXJtYXRpb25Gb3JtIiwiZGVsZXRlQ29uZmlybWF0aW9uQnRuIiwicHJvZmlsZUVkaXRCdXR0b24iLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWwiLCJlZGl0TW9kYWxDbG9zZUJ0biIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJlZGl0U3VibWl0QnRuIiwiY2FyZE1vZGFsIiwiY2FyZE1vZGFsQ2xvc2VCdG4iLCJjYXJkTW9kYWxCdG4iLCJjYXJkRm9ybU1vZGFsTmV3UG9zdCIsImVkaXRDYXJkTmFtZUlucHV0IiwiZWRpdENhcmRMaW5rSW5wdXQiLCJjYXJkU3VibWl0QnRuIiwiY2FyZFRlbXBsYXRlIiwiY2FyZHNMaXN0IiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsSW1nRWwiLCJwcmV2aWV3TW9kYWxDYXB0aW9uRWwiLCJwcmV2aWV3TW9kYWxDbG9zZUJ0biIsImF2YXRhck1vZGFsIiwiYXZhdGFyTW9kYWxCdG4iLCJhdmF0YXJDbG9zZUJ0biIsImF2YXRhclN1Ym1pdEJ0biIsImF2YXRhcklucHV0IiwiYXZhdGFyRm9ybSIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJjaGVja1Jlc3BvbmUiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0QXBwSW5mbyIsImFsbCIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwibWV0aG9kIiwiZWRpdFVzZXJJbmZvIiwiX3JlZjIiLCJuYW1lIiwiYWJvdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRBdmF0YXJJbmZvIiwiYXZhdGFyIiwiYWRkQ2FyZCIsImRhdGEiLCJyZW1vdmVDYXJkIiwiY2FyZElkIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwiY2xvc2VNb2RhbE92ZXJsYXkiLCJoYW5kbGVFc2NhcGUiLCJldnQiLCJ0YXJnZXQiLCJjb250YWlucyIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsZW1lbnQiLCJjYXJkSW1hZ2VFbGVtZW50IiwiY2FyZExpa2VCdG4iLCJjYXJkRGVsZXRlQnRuIiwibGluayIsImFsdCIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJfaWQiLCJ1cGRhdGVkQ2FyZCIsInRvZ2dsZSIsIm5vd0xpa2VkIiwic2V0SXRlbSIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImtleSIsIm1vZGFsT3BlbmVkIiwidXNlckRhdGEiLCJjYXJkcyIsImNhcmQiLCJhcHBlbmQiLCJlcnIiLCJyZXNldFZhbGlkYXRpb24iLCJ2YWx1ZSIsImlucHV0IiwicHJldmVudERlZmF1bHQiLCJ1cGRhdGVkVXNlciIsImZpbmFsbHkiLCJpbnB1dFZhbHVlcyIsInByZXBlbmQiLCJyZXNldCJdLCJzb3VyY2VSb290IjoiIn0=